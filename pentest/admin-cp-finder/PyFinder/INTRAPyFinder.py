############################################################################
#                               Author: Join7                              #
#                              Date: 2012-02-12                            #
#                                                                          #
# Warning: I do not take any responsibility for what you do with this tool.#
############################################################################

import urllib, re, sys

print "#####################################################################"
print "#                         Easy admin Finder                         #"
print "#                                                                   #"
print "#                          By: Team INTRA!                          #"
print "#####################################################################"
print ""
print ""
print "Enter a target, e.g. http://target.com"
print ""
target = raw_input("Please enter a target: ")
if target[:7] == "http://":
        target = target.replace("http://","")
if target[-1] == "/":
        target = target[:-1]

try:
        lines = open("adminpth.txt", "r").readlines()
        linecnt = len(lines)
        print "Loaded %s adminpaths..." % linecnt
        
except(IOError):
        print "Could not load vulnerabilities..."
        raw_input("Press any key to exit")
        quit


file = open("scnresults.txt", "a")
file.writelines("#-----------------------------------------------------------#\n")
c = 0
admc = 0
for line in lines:
    c = c + 1
    line = line.rstrip()
    try:
        source = urllib.urlopen("http://"+target+"/"+line).read()
    except:
        pass
    fourofour = "404"
    notfound = "Page not found"
    if fourofour in source:
        print "["+str(c)+"/"+str(linecnt)+"] http://"+target+"/"+line+": 404"
    elif notfound in source:
        print "["+str(c)+"/"+str(linecnt)+"] http://"+target+"/"+line+ ": Page not found"
    else:
        admc += 1
        print "!ADMIN PAGE FOUND!"
        print "["+str(c)+"/"+str(linecnt)+"] http://"+target+"/"+line+": FOUND!"
        file.writelines("http://"+target+"/"+line+"\n")
file.writelines("#-----------------------------------------------------------#\n")
if admc > 0:
    print str(admc)+ " possible adminpaths found..."
    print "Check adminpth.txt for more information"
    raw_input("Press any key to exit")
else:
    print "No adminpaths where found..."
    raw_input("Press any key to exit")
file.close()
